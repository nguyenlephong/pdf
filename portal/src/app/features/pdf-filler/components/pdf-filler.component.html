<div class="config-section" *ngIf="formFields$ | async as formFields">
  <h3>Fill PDF Form</h3>
  
  <div class="form-group">
    <button class="button" (click)="loadSampleData()">
      Load Sample Data
    </button>
  </div>

  <div class="form-group">
    <label class="flatten-option">
      <input
        type="checkbox"
        [checked]="flattenForm"
        (change)="onFlattenFormChange($event.target.checked)">
      <span class="option-text">
        <strong>Flatten form fields</strong> - Remove borders and keep only text content
        <br>
        <small class="option-hint">
          <span *ngIf="flattenForm">✓ PDF will contain only text without form field borders</span>
          <span *ngIf="!flattenForm">⚠ PDF will keep form field borders</span>
        </small>
      </span>
    </label>
  </div>

  <div *ngIf="formFields.length > 0; else noFields" class="form-fields">
    <div *ngFor="let field of formFields; trackBy: trackByFieldId" class="form-group">
      <label>
        {{ field.label }} 
        <span *ngIf="field.required" class="required">*</span>
      </label>
      <input
        [type]="field.type === 'number' ? 'number' : field.type === 'date' ? 'date' : 'text'"
        [value]="getFormDataValue(field.name)"
        (input)="handleFieldChange(field.name, $event.target.value)"
        [placeholder]="field.placeholder"
        [required]="field.required"
        class="form-input">
    </div>
  </div>

  <ng-template #noFields>
    <p class="no-fields-message">Add form fields to the PDF to enable form filling.</p>
  </ng-template>

  <div class="form-group">
    <button 
      class="button success"
      (click)="generateFilledPDF()"
      [disabled]="isLoading$ | async">
      <span *ngIf="isLoading$ | async">Generating...</span>
      <span *ngIf="!(isLoading$ | async)">
        {{ flattenForm ? 'Generate Filled PDF (No Borders)' : 'Generate Filled PDF (With Borders)' }}
      </span>
    </button>
  </div>

  <div *ngIf="(formData$ | async) as formData" class="form-data-preview">
    <h4>Form Data Preview:</h4>
    <pre class="preview-content">{{ formData | json }}</pre>
  </div>
</div>

<div class="config-section" *ngIf="!(formFields$ | async)?.length">
  <h3>Fill PDF Form</h3>
  <p>Add form fields to the PDF to enable form filling.</p>
</div>
